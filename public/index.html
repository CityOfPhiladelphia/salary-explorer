<!DOCTYPE html>
<html>
<head>
    <title>Salaries</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap.min.css">
    <style>body { padding-top: 60px; }</style>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css">
    <link rel="stylesheet" href="src/stylesheets/styles.css">
</head>
<body>

    <div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<div class="container">
				<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</a>
				<a class="brand" href="#"><img src="img/cityLogo-31px.png"></a>
				<span class="hidden-phone"><a class="brand" href="#"><img src="img/cityLogoMark-145-30.png"></a></span>
				<div class="nav-collapse collapse">
					<ul class="nav">
						<li><a title="Visit The City's Homepage" href="http://www.phila.gov"><i class="icon-home icon-white"></i></a></li>
						<li><a title="Topics" href="http://www.phila.gov/Topics">Topics</a></li>
						<li><a title="People We Serve" href="http://www.phila.gov/PeopleWeServe">People We Serve</a></li>
						<li><a title="Agencies" href="http://www.phila.gov/Agencies">Government</a></li>
						<li><a title="311" href="http://www.phila.gov/311">Contact 311</a></li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	
	<div class="container" id="main"></div>
	
	<div class="loader"><span class="icon"></span></div>
    
    <script type="text/template" id="tmpl-departments">
        <% var icon = function(dir) { return dir === "asc" ? "<i class=\"icon-chevron-up\"></i>" : dir === "desc" ? "<i class=\"icon-chevron-down\"></i>" : ""; }; %>
        <ul class="breadcrumb">
            <li><a href="#">HOME</a> <span class="divider">/</span></li>
            <li class="active">DEPARTMENTS</li>
        </ul>
        <% if(data.rows !== undefined && data.rows.length) { %>
            <a href="#visualize" class="btn">Visualize</a>
            <table class="table table-condensed table-striped-skip no-more-tables">
                <thead>
                    <tr>
                        <th colspan="2"><a href="#<%= data.sortProps.department.href %>" data-replace="true">Department
                            <%= icon(data.sortProps.department.arrow) %>
                        </a></th>
                        <th><a href="#<%= data.sortProps.count.href %>" data-replace="true">Employees
                            <%= icon(data.sortProps.count.arrow) %>
                        </a></th>
                        <th><a href="#<%= data.sortProps.salaries.href %>" data-replace="true">Salaries
                            <%= icon(data.sortProps.salaries.arrow) %>
                        </a></th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="all">
                        <td data-title="Analysis"><button class="btn btn-mini toggle"><i class="icon-plus"></i></button></td>
                        <td data-title="Department"><a href="#employees">ALL EMPLOYEES</a></td>
                        <td data-title="Employees"><%= data.count %></td>
                        <td data-title="Salaries"><%= util.currency("$", data.sum) %></td>
                    </tr>
                    <tr class="analysis">
                        <td colspan="4"></td>
                    </tr>
                <% _.each(data.rows, function(row) { %>
                    <% var count = Math.round(row.count/data.count*100*100)/100; %>
                    <% var salaries = Math.round(row.salaries/data.sum*100*100)/100; %>
                    <tr>
                        <td data-title="Analysis"><button class="btn btn-mini toggle"><i class="icon-plus"></i></button></td>
                        <td data-title="Department"><a href="#employees?department=<%= row.departmentid %>"><%= row.department %></a></td>
                        <td data-title="Employees"><%= row.count %></td>
                        <td data-title="Salaries"><%= util.currency("$", row.salaries) %></td>
                    </tr>
                    <tr class="analysis" data-department="<%= row.departmentid %>">
                        <td colspan="4">
                            This department houses <%= count %>% of the City's employees and receives <%= salaries %>% of the City's salary dollars.
                            <div class="progress">
                                <div class="bar" style="width: <%= count %>%;"><%= count %>%</div>
                            </div>
                            <div class="progress">
                                <div class="bar" style="width: <%= salaries %>%;"><%= salaries %>%</div>
                            </div>
                        </td>
                    </tr>
                <% }); %>
                </tbody>
            </table>
        <% } %>
    </script>
    
    <script type="text/template" id="tmpl-employees">
        <% var icon = function(dir) { return dir === "asc" ? "<i class=\"icon-chevron-up\"></i>" : dir === "desc" ? "<i class=\"icon-chevron-down\"></i>" : ""; } %>
        <ul class="breadcrumb">
            <li><a href="#">HOME</a> <span class="divider">/</span></li>
            <li><a href="#departments">DEPARTMENTS</a> <span class="divider">/</span></li>
            <% if(data.settings.search !== undefined) { %>
                <li><a href="#<%= Salaries.router.buildFragment("employees", {}, ["department"]) %>"><%= data.title %></a> <span class="divider">/</span></li>
                <li class="active">Search Results</li>
            <% } else { %>
                <li class="active"><%= data.title %></li>
            <% } %>
        </ul>
    	<div class="row">
    		<div id="title" class="span4"><h3><%= data.title %></h3></div>
    		<div class="span4">
                <div class="btn-group hidden-tablet hidden-desktop">
                    <a class="btn dropdown-toggle" data-toggle="dropdown" href="#"><i class="icon-th-list"></i> Sort <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        
                        <% if(data.settings.department === undefined) { %>
                        <li><a href="#<%= data.sortProps.department.href %>" data-replace="true">Department
                            <%= icon(data.sortProps.department.arrow) %>
                        </a></li>
                        <% } %>
                        <li><a href="#<%= data.sortProps.lastname.href %>" data-replace="true">Last Name
                            <%= icon(data.sortProps.lastname.arrow) %>
                        </a></li>
                        <li><a href="#<%= data.sortProps.firstname.href %>" data-replace="true">First Name
                            <%= icon(data.sortProps.firstname.arrow) %>
                        </a></li>
                        <li><a href="#<%= data.sortProps.middleinitial.href %>" data-replace="true">Middle Initial
                            <%= icon(data.sortProps.middleinitial.arrow) %>
                        </a></li>
                        <li><a href="#<%= data.sortProps.title.href %>" data-replace="true">Title
                            <%= icon(data.sortProps.title.arrow) %>
                        </a></li>
                        <li><a href="#<%= data.sortProps.salary.href %>" data-replace="true">Salary
                            <%= icon(data.sortProps.salary.arrow) %>
                        </a></li>
                    </ul>
                </div>
            </div>
			<div id="search" class="span4">
                <form class="form-search pull-right">
            		<% var search = data.settings.search || null; %>
        			<div class="input-append<% if(search) { %> input-prepend<% } %>">
        				<% if(search) { %><a href="#<%= Salaries.router.buildFragment("employees", {}, ["department"]) %>" class="add-on"><i class="icon-remove"></i></a><% } %>
        				<input name="search" placeholder="Search<% if(data.title) { %> <%= data.title %><% } %>" type="text" class="<% if( ! search) { %> search-query<% } %>"<% if(search) { %> value="<%= search %>"<% } %>>
        				<button type="submit" class="btn"><i class="icon-search"></i></button>
        			</div>
        		</form>
            </div>
		</div>
        <% if(data.rows !== undefined && data.rows.length) { %>
            <table class="table table-condensed table-striped no-more-tables">
                <thead>
                <% if(data.settings.department === undefined) { %>
                    <th><a href="#<%= data.sortProps.department.href %>" data-replace="true">Department
                        <%= icon(data.sortProps.department.arrow) %>
                    </a></th>
                <% } %>
                    <th><a href="#<%= data.sortProps.lastname.href %>" data-replace="true">Last Name
                        <%= icon(data.sortProps.lastname.arrow) %>
                    </a></th>
                    <th><a href="#<%= data.sortProps.firstname.href %>" data-replace="true">First Name
                        <%= icon(data.sortProps.firstname.arrow) %>
                    </a></th>
                    <th><a href="#<%= data.sortProps.middleinitial.href %>" data-replace="true">Middle Initial
                        <%= icon(data.sortProps.middleinitial.arrow) %>
                    </a></th>
                    <th><a href="#<%= data.sortProps.title.href %>" data-replace="true">Title
                        <%= icon(data.sortProps.title.arrow) %>
                    </a></th>
                    <th><a href="#<%= data.sortProps.salary.href %>" data-replace="true">Salary
                        <%= icon(data.sortProps.salary.arrow) %>
                    </a></th>
                </thead>
                <tbody>
                </tbody>
            </table>
            <button class="btn btn-large btn-block more" data-loading-text="Loading..." data-error-text="Error">More</button>
        <% } else if(data.error) { %>
            <div class="alert alert-error"><%= data.error %></div>
        <% } else { %>
            <div class="alert hide-loading">No results found</div>
        <% } %>
        <% if(data.settings.search !== undefined && data.settings.department !== undefined) { %>
            <div class="alert alert-info hide-loading">You just searched through <%= data.title %>. Did you mean to search through <a href="#<%= Salaries.router.buildFragment("employees", {}, ["search"]) %>">All Employees</a>?</div>
        <% } %>
    </script>
    
    <script type="text/template" id="tmpl-employee">
        <% if(data.settings.department === undefined) { %>
        <td data-title="Dept"><%= data.row.department %></td>
        <% } %>
        <td data-title="Last"><%= data.row.lastname || "&nbsp;" %></td>
        <td data-title="First"><%= data.row.firstname || "&nbsp;" %></td>
        <td data-title="Middle"><%= data.row.middleinitial || "&nbsp;" %></td>
        <td data-title="Title"><%= data.row.title || "N/A" %></td>
        <td data-title="Salary"><%= util.currency("$", data.row.salary) %></td>
    </script>
    
    <script type="text/template" id="tmpl-salarygroups">
        <% var classes = ["bar-info", "bar-warning", "bar-success", "bar-danger"]; %>
        <% if(data.rows !== undefined && data.rows.length) { %>
            <div class="progress buckets">
            <% _.each(data.buckets, function(bucket, index) { %>
                <div class="bar <%= classes[index % classes.length] %>" style="width: <%= bucket.percentage %>%;" rel="tooltip" title="<%= bucket.count %> Employees (<%= Math.round(bucket.percentage) %>%)">
                    $<%= bucket.min %>-<%= bucket.max %>k
                </div>
            <% }); %>
            </div>
        <% } %>
    </script>
    
    <script type="text/template" id="tmpl-visualize">
        <ul class="breadcrumb">
            <li><a href="#">HOME</a> <span class="divider">/</span></li>
            <li><a href="#departments">DEPARTMENTS</a> <span class="divider">/</span></li>
            <li class="active">VISUALIZE</li>
        </ul>
        <div id="stacked"></div>
        <div id="combined"></div>
    </script>
    
    <script type="text/template" id="tmpl-home">
    	<div class="hero-unit">
			<h1>Philly Salaries</h1>
			<p>You can use this application to browse salary data for Fiscal Year 2012.</p>
			<p>
				<a href="#departments" class="btn btn-large btn-success">View Salaries</a>
			</p>
			<!--<p>
				<a href="https://www.google.com/fusiontables/DataSource?docid=" target="_blank" class="btn btn-small"><i class="icon-download"></i> Export Data</a>
				<a href="http://github.com" target="_blank" class="btn btn-small"><i class="icon-align-left"></i> Source Code</a>
			</p>-->
		</div>
    </script>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.4/underscore-min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.9/backbone-min.js"></script>
    <!--<script src="//cdnjs.cloudflare.com/ajax/libs/backbone.paginator/0.5/backbone.paginator.min.js"></script>-->
    <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highcharts/2.3.5/highcharts.js"></script>
    <script src="lib/javascripts/backbone.queryparams.js"></script>
    <script src="lib/javascripts/jquery.jsonp.js"></script>
    <script src="src/javascripts/codes.js"></script>
    <script src="src/javascripts/util.js"></script>
    <script src="src/javascripts/fusiontable.js"></script>
    <script src="src/javascripts/department.js"></script>
    <script src="src/javascripts/employee.js"></script>
    <script src="src/javascripts/salarygroup.js"></script>
    <script src="src/javascripts/app.js"></script>
</body>
</html>